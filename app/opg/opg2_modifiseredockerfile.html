<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Docker Workshop - Modifiser Docker</title>

    <link rel="stylesheet" href="/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/node_modules/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../style.css">

    <script src="/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>


    <script type="text/javascript">
        $(document).ready(function () {
            $('#navigation').load('../navbar.html');

         /*   $('.task').each(function() {
                var $id = $(this).attr("id");
                var dataElem = {"task": $id};
                $.ajax({
                    url: '/check',
                    data: {
                        task: $id
                    }
                }).done(function(data) {
                    if(data === "korrekt") {
                        $('#' + $id).append('<span class="fa fa-check-circle"></span>');
                    } else {
                        $('#' + $id).append('<span class="fa fa-times-circle">'+data+'</span>');
                    }
                });
            });*/
        });
    </script>
</head>

<body>

<div class="nav-container">
    <div id="navigation" ></div>
</div>

<div class="container">
    <h1>Oppgave 2 - Modifisering av Dockerfile</h1>
    <p>
        Til nå har vi bare brukt en veldig enkel dockerfil, som baserer seg på et eksisterende image,
        legger til en fil og deretter kjører denne ved oppstart. Det er mye mer man kan gjøre ved opprettelsen
        av images, og i denne oppgaven skal vi se på noen av dem.
    </p>
    <p>
        Hva som skal være inkludert i vårt ferdige docker-image kan styres ved å forandre hvilket image vi baserer oss på.
        Hittil har vi basert dockerfilen vår på <a href="https://hub.docker.com/_/alpine/">Alpine</a>, som er en ekstremt
        nedstrippet linux-versjon. Dette er et default image som ofte brukes, og har fordelen at det gir små containere
        med rask oppstartstid. Den mangler dog noen grunnleggende ting, som for eksempel Bash og Java.
    </p>
    <p>
        Merk at henting av image man baserer seg på, og installering av pakker, skjer under byggingen av imaget.
        Dette betyr at selve byggingen tar mer tid jo mer man gjør, og i tillegg vil imaget ta mer lagringsplass. Oppstartstid av
        containeren blir ikke merkbart påvirket av dette. Ting som derimot vil påvirke oppstartstid er kjøring av scripts,
        oppstart av applikasjoner etc.
    </p>

    <h2>a)</h2>
    <p>
        Endre Dockerfile i mappen 'oppgave_2' slik at den legger til scriptet "hei.sh", og kjører dette ved oppstart. Observer at dette feiler,
        ettersom programmet bash ikke finnes i imaget vi baserer oss på.
    </p>

    <h2>b)</h2>
    <p>
        Bruk Dockers søke-kommando for å finne det offisielle ubuntu-imaget, som inneholder bash, og endre din Dockerfile
        slik at den baserer seg på den nyeste versjonen av dette. Denne kommandoen genererer en liste over matchende images
        fra Docker Hub. Det er også mulig å gå inn på <a href="https://hub.docker.com/">Docker Hub</a> og finne imaget der.

        Bygg og kjør fra Dockerfile på nytt, denne gangen basert på Ubuntu, og observer at containeren nå har tilgang
        på bash, og at scriptet blir kjørt når containeren starter opp!
    </p>

    <h2>c)</h2>
    <p>
        Det er også mulig å modifisere imaget ved å installere ekstra pakker. Bruk Ubuntus package manager APT via RUN-kommandoen
        i Dockerfile til å installere pakken "curl". Denne blir da installert under byggingen av imaget, og vil være
        tilgjengelig når containeren startes. Endre også Dockerfilen slik at den kjører for eksempel &ltcurl -L checkip.dyndns.org&gt
        ved oppstart. Observer at curl nå er installert og fungerer.
    </p>



    <b>NB: dersom docker har problemer med tilkobling til repositories kan det hjelpe å skru av VPN.</b>

    <h2>Nyttige lenker</h2>
    <ul>
        <li><a href="https://docs.docker.com/engine/userguide/containers/dockerimages/">Docker Docs - Images</a></li>
        <li><a href="https://docs.docker.com/engine/reference/builder/#cmd">Dockerfile CMD</a></li>
        <li><a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/">
            Dockerfile Best Practices (dekker også bruk av apt-get)</a></li>
    </ul>

</div>

</body>
</html>